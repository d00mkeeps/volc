2025-08-15 14:45:30,622 - app.api.endpoints.images - INFO - User ID type: <class 'str'>
2025-08-15 14:45:30,624 - app.api.endpoints.images - INFO - JWT token length: 875
2025-08-15 14:45:30,624 - app.api.endpoints.images - INFO - JWT starts with: eyJhbGciOiJIUzI1NiIsImtpZCI6IlZxeno3RjFVNVFDSmkvN2...
2025-08-15 14:45:30,894 - app.api.endpoints.images - INFO - User client created successfully: True
2025-08-15 14:45:31,238 - app.api.endpoints.images - INFO - Test query successful: True
2025-08-15 14:45:31,239 - app.services.db.image_service - INFO - Creating temp image with path: 1b6aebb0-1107-42fc-97f2-892cc56b706b/40fe4c90-6fc8-4765-9749-d269fb807954.jpg
2025-08-15 14:45:31,239 - app.services.db.image_service - INFO - User ID to insert: 1b6aebb0-1107-42fc-97f2-892cc56b706b (type: <class 'str'>)
2025-08-15 14:45:31,518 - app.services.db.image_service - INFO - About to insert: {'file_path': '1b6aebb0-1107-42fc-97f2-892cc56b706b/40fe4c90-6fc8-4765-9749-d269fb807954.jpg', 'user_id': '1b6aebb0-1107-42fc-97f2-892cc56b706b', 'status': 'temporary', 'expires_at': '2025-08-16T13:45:31.518003'}
2025-08-15 14:45:31,833 - app.services.db.image_service - INFO - Created temp image record with ID: 2890551e-a4f8-4186-ab1e-de063b58ae8a
2025-08-15 14:45:31,833 - app.services.db.image_service - INFO - About to create signed URL...
2025-08-15 14:45:32,178 - app.services.db.image_service - INFO - Signed URL response type: <class 'dict'>
2025-08-15 14:45:32,178 - app.services.db.image_service - INFO - Signed URL response: {'signed_url': 'https://sfniyudipwsaqwuhsdcq.supabase.co/storage/v1/object/upload/sign/images/1b6aebb0-1107-42fc-97f2-892cc56b706b/40fe4c90-6fc8-4765-9749-d269fb807954.jpg?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wNDg3ODljNy1mYmQ1LTQ4OWQtYjVmNC03NjM1NWFhMDRhODYiLCJhbGciOiJIUzI1NiJ9.eyJvd25lciI6IjFiNmFlYmIwLTExMDctNDJmYy05N2YyLTg5MmNjNTZiNzA2YiIsInVybCI6ImltYWdlcy8xYjZhZWJiMC0xMTA3LTQyZmMtOTdmMi04OTJjYzU2YjcwNmIvNDBmZTRjOTAtNmZjOC00NzY1LTk3NDktZDI2OWZiODA3OTU0LmpwZyIsInVwc2VydCI6ZmFsc2UsImlhdCI6MTc1NTI2NTUzMiwiZXhwIjoxNzU1MjcyNzMyfQ.xm8xAYFbEcmgxCGweGGKQhka6lJKBBNU9LkCIq5R54A', 'signedUrl': 'https://sfniyudipwsaqwuhsdcq.supabase.co/storage/v1/object/upload/sign/images/1b6aebb0-1107-42fc-97f2-892cc56b706b/40fe4c90-6fc8-4765-9749-d269fb807954.jpg?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wNDg3ODljNy1mYmQ1LTQ4OWQtYjVmNC03NjM1NWFhMDRhODYiLCJhbGciOiJIUzI1NiJ9.eyJvd25lciI6IjFiNmFlYmIwLTExMDctNDJmYy05N2YyLTg5MmNjNTZiNzA2YiIsInVybCI6ImltYWdlcy8xYjZhZWJiMC0xMTA3LTQyZmMtOTdmMi04OTJjYzU2YjcwNmIvNDBmZTRjOTAtNmZjOC00NzY1LTk3NDktZDI2OWZiODA3OTU0LmpwZyIsInVwc2VydCI6ZmFsc2UsImlhdCI6MTc1NTI2NTUzMiwiZXhwIjoxNzU1MjcyNzMyfQ.xm8xAYFbEcmgxCGweGGKQhka6lJKBBNU9LkCIq5R54A', 'token': 'eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wNDg3ODljNy1mYmQ1LTQ4OWQtYjVmNC03NjM1NWFhMDRhODYiLCJhbGciOiJIUzI1NiJ9.eyJvd25lciI6IjFiNmFlYmIwLTExMDctNDJmYy05N2YyLTg5MmNjNTZiNzA2YiIsInVybCI6ImltYWdlcy8xYjZhZWJiMC0xMTA3LTQyZmMtOTdmMi04OTJjYzU2YjcwNmIvNDBmZTRjOTAtNmZjOC00NzY1LTk3NDktZDI2OWZiODA3OTU0LmpwZyIsInVwc2VydCI6ZmFsc2UsImlhdCI6MTc1NTI2NTUzMiwiZXhwIjoxNzU1MjcyNzMyfQ.xm8xAYFbEcmgxCGweGGKQhka6lJKBBNU9LkCIq5R54A', 'path': '1b6aebb0-1107-42fc-97f2-892cc56b706b/40fe4c90-6fc8-4765-9749-d269fb807954.jpg'}
2025-08-15 14:45:32,179 - app.services.db.image_service - INFO - Successfully created upload URL
2025-08-15 14:45:32,179 - app.services.db.image_service - INFO - Returning response: {'image_id': '2890551e-a4f8-4186-ab1e-de063b58ae8a', 'upload_url': 'https://sfniyudipwsaqwuhsdcq.supabase.co/storage/v1/object/upload/sign/images/1b6aebb0-1107-42fc-97f2-892cc56b706b/40fe4c90-6fc8-4765-9749-d269fb807954.jpg?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wNDg3ODljNy1mYmQ1LTQ4OWQtYjVmNC03NjM1NWFhMDRhODYiLCJhbGciOiJIUzI1NiJ9.eyJvd25lciI6IjFiNmFlYmIwLTExMDctNDJmYy05N2YyLTg5MmNjNTZiNzA2YiIsInVybCI6ImltYWdlcy8xYjZhZWJiMC0xMTA3LTQyZmMtOTdmMi04OTJjYzU2YjcwNmIvNDBmZTRjOTAtNmZjOC00NzY1LTk3NDktZDI2OWZiODA3OTU0LmpwZyIsInVwc2VydCI6ZmFsc2UsImlhdCI6MTc1NTI2NTUzMiwiZXhwIjoxNzU1MjcyNzMyfQ.xm8xAYFbEcmgxCGweGGKQhka6lJKBBNU9LkCIq5R54A', 'file_path': '1b6aebb0-1107-42fc-97f2-892cc56b706b/40fe4c90-6fc8-4765-9749-d269fb807954.jpg'}
2025-08-15 14:45:32,180 - app.main - INFO - Request: POST /api/workout-analysis
2025-08-15 14:45:32,180 - app.main - INFO - Response status: 200
2025-08-15 14:45:32,183 - app.services.db.conversation_service - INFO - Creating conversation for user: 1b6aebb0-1107-42fc-97f2-892cc56b706b
2025-08-15 14:45:32,919 - app.services.workout_analysis_service - INFO - Conversation service returned: {'success': True, 'data': {'id': '6ff776c4-ca19-4ab5-bea1-347b3b5ea5f2', 'user_id': '1b6aebb0-1107-42fc-97f2-892cc56b706b', 'title': 'Analysis - Aug 15', 'config_name': 'workout-analysis', 'created_at': '2025-08-15T13:45:32.871533+00:00', 'updated_at': '2025-08-15T13:45:32.871533+00:00', 'status': 'active', 'message_count': 0}, 'error': None}
2025-08-15 14:45:32,919 - app.services.workout_analysis_service - INFO - Starting analysis task for conversation: 6ff776c4-ca19-4ab5-bea1-347b3b5ea5f2
2025-08-15 14:45:32,920 - app.services.db.analysis_service - INFO - Creating empty analysis bundle: a19b6636-eacb-4b47-bc09-272856a7729b for conversation: 6ff776c4-ca19-4ab5-bea1-347b3b5ea5f2
2025-08-15 14:45:33,568 - app.services.db.analysis_service - INFO - Empty bundle created successfully with ID: a19b6636-eacb-4b47-bc09-272856a7729b
2025-08-15 14:45:33,568 - app.services.workout_analysis_service - INFO - Created empty bundle: a19b6636-eacb-4b47-bc09-272856a7729b
2025-08-15 14:45:33,569 - app.services.db.analysis_service - INFO - Updating bundle a19b6636-eacb-4b47-bc09-272856a7729b status to: in_progress
2025-08-15 14:45:34,208 - app.services.db.analysis_service - INFO - Bundle status updated successfully: a19b6636-eacb-4b47-bc09-272856a7729b -> in_progress
2025-08-15 14:45:34,208 - app.services.db.workout_service - INFO - Calling RPC for user: 1b6aebb0-1107-42fc-97f2-892cc56b706b, definitions: ['f42cf0c2-51cf-4e22-9b1c-d7b83f5c62fa', '2f08941a-a4e0-4feb-bb3c-01fda83615b4', '0d669895-ab29-4a87-a293-99b77950a5c4']
2025-08-15 14:45:34,750 - app.services.db.workout_service - INFO - RPC returned: 5 workouts
2025-08-15 14:45:34,751 - app.services.workout_analysis_service - INFO - Processing analysis for 5 workouts
2025-08-15 14:45:34,751 - app.services.workout_analysis.main_processor - INFO - Processing bundle a19b6636-eacb-4b47-bc09-272856a7729b with 5 workouts
2025-08-15 14:45:34,751 - app.services.workout_analysis.calc.strength - INFO - Found 3 exercises with strength data, returning top 3
2025-08-15 14:45:34,751 - app.services.workout_analysis.calc.strength - INFO - Generated time series for 3 exercises
2025-08-15 14:45:34,751 - app.services.workout_analysis.calc.volume - INFO - Found 3 exercises with volume data, returning top 3
2025-08-15 14:45:34,751 - app.services.workout_analysis.calc.volume - INFO - Generated time series for 3 exercises
2025-08-15 14:45:34,752 - app.services.workout_analysis.calc.consistency - INFO - Calculated consistency: avg_gap=0.0, variance=0.0031482343701035496
2025-08-15 14:45:34,779 - app.services.workout_analysis.main_processor - INFO - Successfully processed bundle a19b6636-eacb-4b47-bc09-272856a7729b
2025-08-15 14:45:34,779 - app.services.db.analysis_service - INFO - Updating analysis bundle: a19b6636-eacb-4b47-bc09-272856a7729b
2025-08-15 14:45:35,452 - app.services.db.analysis_service - INFO - Bundle updated successfully: a19b6636-eacb-4b47-bc09-272856a7729b
2025-08-15 14:45:35,452 - app.services.workout_analysis_service - INFO - Analysis task completed successfully for conversation 6ff776c4-ca19-4ab5-bea1-347b3b5ea5f2
2025-08-15 14:45:35,452 - app.main - INFO - Response status: 200
2025-08-15 14:45:35,806 - app.main - INFO - Request: GET /images/2890551e-a4f8-4186-ab1e-de063b58ae8a/url
2025-08-15 14:45:35,807 - app.api.endpoints.images - INFO - API request to get image URL: 2890551e-a4f8-4186-ab1e-de063b58ae8a
2025-08-15 14:45:35,808 - app.services.db.image_service - INFO - Getting image URL for ID: 2890551e-a4f8-4186-ab1e-de063b58ae8a
2025-08-15 14:45:36,328 - app.services.db.image_service - INFO - Found file path: 1b6aebb0-1107-42fc-97f2-892cc56b706b/40fe4c90-6fc8-4765-9749-d269fb807954.jpg
2025-08-15 14:45:36,345 - app.services.db.image_service - INFO - Public URL response type: <class 'str'>
2025-08-15 14:45:36,345 - app.services.db.image_service - INFO - Public URL response: https://sfniyudipwsaqwuhsdcq.supabase.co/storage/v1/object/public/images/1b6aebb0-1107-42fc-97f2-892cc56b706b/40fe4c90-6fc8-4765-9749-d269fb807954.jpg?
2025-08-15 14:45:36,345 - app.services.db.image_service - INFO - Public URL keys: Not a dict
2025-08-15 14:45:36,345 - app.services.db.image_service - INFO - Used direct string
2025-08-15 14:45:36,346 - app.services.db.image_service - INFO - Final public URL: https://sfniyudipwsaqwuhsdcq.supabase.co/storage/v1/object/public/images/1b6aebb0-1107-42fc-97f2-892cc56b706b/40fe4c90-6fc8-4765-9749-d269fb807954.jpg?
2025-08-15 14:45:36,346 - app.main - INFO - Response status: 200
2025-08-15 14:45:52,355 - app.main - INFO - Request: PUT /db/workouts/33f7cbad-0a63-4951-816c-e95d610e7fda
2025-08-15 14:45:52,359 - app.api.endpoints.db - INFO - API request to update workout: 33f7cbad-0a63-4951-816c-e95d610e7fda
2025-08-15 14:45:52,360 - app.services.db.workout_service - INFO - Updating workout: 33f7cbad-0a63-4951-816c-e95d610e7fda
2025-08-15 14:45:54,110 - app.services.db.workout_service - INFO - Successfully updated workout: 33f7cbad-0a63-4951-816c-e95d610e7fda
2025-08-15 14:45:54,112 - app.main - INFO - Response status: 200
2025-08-15 14:45:54,471 - app.main - INFO - Request: POST /images/2890551e-a4f8-4186-ab1e-de063b58ae8a/commit
2025-08-15 14:45:54,474 - app.api.endpoints.images - INFO - API request to commit image: 2890551e-a4f8-4186-ab1e-de063b58ae8a
2025-08-15 14:45:54,475 - app.services.db.image_service - INFO - Committing image to permanent: 2890551e-a4f8-4186-ab1e-de063b58ae8a
