2024-12-06 14:39:38,004 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 06 Dec 2024 14:39:37 GMT'), (b'Content-Type', b'text/event-stream; charset=utf-8'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Cache-Control', b'no-cache'), (b'anthropic-ratelimit-requests-limit', b'50'), (b'anthropic-ratelimit-requests-remaining', b'49'), (b'anthropic-ratelimit-requests-reset', b'2024-12-06T14:39:38Z'), (b'anthropic-ratelimit-input-tokens-limit', b'40000'), (b'anthropic-ratelimit-input-tokens-remaining', b'37000'), (b'anthropic-ratelimit-input-tokens-reset', b'2024-12-06T14:39:41Z'), (b'anthropic-ratelimit-output-tokens-limit', b'8000'), (b'anthropic-ratelimit-output-tokens-remaining', b'7000'), (b'anthropic-ratelimit-output-tokens-reset', b'2024-12-06T14:39:44Z'), (b'anthropic-ratelimit-tokens-limit', b'48000'), (b'anthropic-ratelimit-tokens-remaining', b'44000'), (b'anthropic-ratelimit-tokens-reset', b'2024-12-06T14:39:41Z'), (b'request-id', b'req_017csiK9zYjgoE1GteCi2BL4'), (b'via', b'1.1 google'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8edd06bfaa1db3e1-MAN')])
2024-12-06 14:39:38,007 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2024-12-06 14:39:38,007 - anthropic._base_client - DEBUG - HTTP Request: POST https://api.anthropic.com/v1/messages "200 OK"
2024-12-06 14:39:38,008 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-12-06 14:39:39,338 - httpcore.http11 - DEBUG - receive_response_body.complete
2024-12-06 14:39:39,338 - httpcore.http11 - DEBUG - response_closed.started
2024-12-06 14:39:39,339 - httpcore.http11 - DEBUG - response_closed.complete
2024-12-06 14:39:42,964 - app.services.onboarding_service - INFO - Received message: Looks good!
2024-12-06 14:39:42,967 - anthropic._base_client - DEBUG - Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': [{'type': 'text', 'text': 'Summary: {\n  "personalInfo": {\n    "firstName": "Miles",\n    "lastName": "Hillary",\n    "ageGroup": "18-24",\n    "preferredUnits": "metric"\n  },\n  "goal": "Squat 200kg by June 2025",\n  "fitnessBackground": {\n    "trainingAge": "3 years",\n    "exercisePreferences": [\n      "powerlifting",\n      "running"\n    ],\n    "currentAbilities": [\n      "Squat 170kg"\n    ],\n    "injuries": [\n      "tight posterior chain"\n    ]\n  }\n}\n    User\'s Response: Looks good!'}, {'type': 'text', 'text': '{current_message}'}]}], 'model': 'claude-3-sonnet-20240229', 'stream': True, 'system': "Analyze if the user's response fully approves the summary or requests any changes.\nRules:\n- Return 'APPROVE' only if the response indicates complete acceptance\n- Return 'REJECT' if:\n  * Any changes are requested, even minor ones\n  * User seems unsure or asks questions\n  * User indicates any information is incorrect or missing\n  * User wants to add or modify any details"}}
2024-12-06 14:39:42,968 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-12-06 14:39:42,969 - httpcore.http11 - DEBUG - send_request_headers.complete
2024-12-06 14:39:42,969 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-12-06 14:39:42,970 - httpcore.http11 - DEBUG - send_request_body.complete
2024-12-06 14:39:42,970 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-12-06 14:39:43,880 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 06 Dec 2024 14:39:43 GMT'), (b'Content-Type', b'text/event-stream; charset=utf-8'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Cache-Control', b'no-cache'), (b'anthropic-ratelimit-requests-limit', b'50'), (b'anthropic-ratelimit-requests-remaining', b'49'), (b'anthropic-ratelimit-requests-reset', b'2024-12-06T14:39:44Z'), (b'anthropic-ratelimit-input-tokens-limit', b'40000'), (b'anthropic-ratelimit-input-tokens-remaining', b'40000'), (b'anthropic-ratelimit-input-tokens-reset', b'2024-12-06T14:39:43Z'), (b'anthropic-ratelimit-output-tokens-limit', b'8000'), (b'anthropic-ratelimit-output-tokens-remaining', b'7000'), (b'anthropic-ratelimit-output-tokens-reset', b'2024-12-06T14:39:50Z'), (b'anthropic-ratelimit-tokens-limit', b'48000'), (b'anthropic-ratelimit-tokens-remaining', b'47000'), (b'anthropic-ratelimit-tokens-reset', b'2024-12-06T14:39:43Z'), (b'request-id', b'req_01PUan2zW7gfyTUNVckqrMsN'), (b'via', b'1.1 google'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8edd06e5b9bab3e1-MAN')])
2024-12-06 14:39:43,881 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2024-12-06 14:39:43,881 - anthropic._base_client - DEBUG - HTTP Request: POST https://api.anthropic.com/v1/messages "200 OK"
2024-12-06 14:39:43,882 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-12-06 14:39:43,897 - httpcore.http11 - DEBUG - receive_response_body.complete
2024-12-06 14:39:43,898 - httpcore.http11 - DEBUG - response_closed.started
2024-12-06 14:39:43,898 - httpcore.http11 - DEBUG - response_closed.complete
2024-12-06 14:39:43,905 - anthropic._base_client - DEBUG - Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'json_data': {'max_tokens': 1024, 'messages': [{'role': 'user', 'content': [{'type': 'text', 'text': 'Summary: {\n  "personalInfo": {\n    "firstName": "Miles",\n    "lastName": "Hillary",\n    "ageGroup": "18-24",\n    "preferredUnits": "metric"\n  },\n  "goal": "Squat 200kg by June 2025",\n  "fitnessBackground": {\n    "trainingAge": "3 years",\n    "exercisePreferences": [\n      "powerlifting",\n      "running"\n    ],\n    "currentAbilities": [\n      "Squat 170kg"\n    ],\n    "injuries": [\n      "tight posterior chain"\n    ]\n  }\n}\n    User\'s Response: Looks good!'}, {'type': 'text', 'text': '{current_message}'}]}], 'model': 'claude-3-sonnet-20240229', 'stream': True, 'system': "Analyze if the user's response fully approves the summary or requests any changes.\nRules:\n- Return 'APPROVE' only if the response indicates complete acceptance\n- Return 'REJECT' if:\n  * Any changes are requested, even minor ones\n  * User seems unsure or asks questions\n  * User indicates any information is incorrect or missing\n  * User wants to add or modify any details"}}
2024-12-06 14:39:43,906 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
2024-12-06 14:39:43,906 - httpcore.http11 - DEBUG - send_request_headers.complete
2024-12-06 14:39:43,906 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
2024-12-06 14:39:43,906 - httpcore.http11 - DEBUG - send_request_body.complete
2024-12-06 14:39:43,906 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
2024-12-06 14:39:44,776 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Fri, 06 Dec 2024 14:39:44 GMT'), (b'Content-Type', b'text/event-stream; charset=utf-8'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Cache-Control', b'no-cache'), (b'anthropic-ratelimit-requests-limit', b'50'), (b'anthropic-ratelimit-requests-remaining', b'48'), (b'anthropic-ratelimit-requests-reset', b'2024-12-06T14:39:45Z'), (b'anthropic-ratelimit-input-tokens-limit', b'40000'), (b'anthropic-ratelimit-input-tokens-remaining', b'40000'), (b'anthropic-ratelimit-input-tokens-reset', b'2024-12-06T14:39:44Z'), (b'anthropic-ratelimit-output-tokens-limit', b'8000'), (b'anthropic-ratelimit-output-tokens-remaining', b'7000'), (b'anthropic-ratelimit-output-tokens-reset', b'2024-12-06T14:39:51Z'), (b'anthropic-ratelimit-tokens-limit', b'48000'), (b'anthropic-ratelimit-tokens-remaining', b'47000'), (b'anthropic-ratelimit-tokens-reset', b'2024-12-06T14:39:44Z'), (b'request-id', b'req_01A3RCMdCrhuTwBPbgXQxaZZ'), (b'via', b'1.1 google'), (b'CF-Cache-Status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'8edd06eb8b13b3e1-MAN')])
2024-12-06 14:39:44,777 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2024-12-06 14:39:44,778 - anthropic._base_client - DEBUG - HTTP Request: POST https://api.anthropic.com/v1/messages "200 OK"
2024-12-06 14:39:44,780 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
2024-12-06 14:39:44,817 - httpcore.http11 - DEBUG - receive_response_body.complete
2024-12-06 14:39:44,817 - httpcore.http11 - DEBUG - response_closed.started
2024-12-06 14:39:44,818 - httpcore.http11 - DEBUG - response_closed.complete
2024-12-06 14:39:47,098 - app.services.onboarding_service - INFO - WebSocket disconnected
2024-12-06 14:39:47,098 - app.services.onboarding_service - INFO - WebSocket connection closed
