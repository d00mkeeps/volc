2025-08-11 17:44:51,506 - app.services.db.image_service - INFO - Signed URL response: {'signed_url': 'https://sfniyudipwsaqwuhsdcq.supabase.co/storage/v1/object/upload/sign/images/1e2d6190-5d52-4f48-974c-7a5a43a50bf3/4f1af611-200c-4641-ba3d-fe9a01987811.jpg?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wNDg3ODljNy1mYmQ1LTQ4OWQtYjVmNC03NjM1NWFhMDRhODYiLCJhbGciOiJIUzI1NiJ9.eyJvd25lciI6IjFlMmQ2MTkwLTVkNTItNGY0OC05NzRjLTdhNWE0M2E1MGJmMyIsInVybCI6ImltYWdlcy8xZTJkNjE5MC01ZDUyLTRmNDgtOTc0Yy03YTVhNDNhNTBiZjMvNGYxYWY2MTEtMjAwYy00NjQxLWJhM2QtZmU5YTAxOTg3ODExLmpwZyIsInVwc2VydCI6ZmFsc2UsImlhdCI6MTc1NDkzMDY5MSwiZXhwIjoxNzU0OTM3ODkxfQ.ZBjj07BfPeynCAPLT4R3VneimrdiZzV4NSCUePT8znw', 'signedUrl': 'https://sfniyudipwsaqwuhsdcq.supabase.co/storage/v1/object/upload/sign/images/1e2d6190-5d52-4f48-974c-7a5a43a50bf3/4f1af611-200c-4641-ba3d-fe9a01987811.jpg?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wNDg3ODljNy1mYmQ1LTQ4OWQtYjVmNC03NjM1NWFhMDRhODYiLCJhbGciOiJIUzI1NiJ9.eyJvd25lciI6IjFlMmQ2MTkwLTVkNTItNGY0OC05NzRjLTdhNWE0M2E1MGJmMyIsInVybCI6ImltYWdlcy8xZTJkNjE5MC01ZDUyLTRmNDgtOTc0Yy03YTVhNDNhNTBiZjMvNGYxYWY2MTEtMjAwYy00NjQxLWJhM2QtZmU5YTAxOTg3ODExLmpwZyIsInVwc2VydCI6ZmFsc2UsImlhdCI6MTc1NDkzMDY5MSwiZXhwIjoxNzU0OTM3ODkxfQ.ZBjj07BfPeynCAPLT4R3VneimrdiZzV4NSCUePT8znw', 'token': 'eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wNDg3ODljNy1mYmQ1LTQ4OWQtYjVmNC03NjM1NWFhMDRhODYiLCJhbGciOiJIUzI1NiJ9.eyJvd25lciI6IjFlMmQ2MTkwLTVkNTItNGY0OC05NzRjLTdhNWE0M2E1MGJmMyIsInVybCI6ImltYWdlcy8xZTJkNjE5MC01ZDUyLTRmNDgtOTc0Yy03YTVhNDNhNTBiZjMvNGYxYWY2MTEtMjAwYy00NjQxLWJhM2QtZmU5YTAxOTg3ODExLmpwZyIsInVwc2VydCI6ZmFsc2UsImlhdCI6MTc1NDkzMDY5MSwiZXhwIjoxNzU0OTM3ODkxfQ.ZBjj07BfPeynCAPLT4R3VneimrdiZzV4NSCUePT8znw', 'path': '1e2d6190-5d52-4f48-974c-7a5a43a50bf3/4f1af611-200c-4641-ba3d-fe9a01987811.jpg'}
2025-08-11 17:44:51,508 - app.services.db.image_service - INFO - Successfully created upload URL
2025-08-11 17:44:51,508 - app.services.db.image_service - INFO - Returning response: {'image_id': '52db1980-f61f-481f-b4e4-648b3522b33f', 'upload_url': 'https://sfniyudipwsaqwuhsdcq.supabase.co/storage/v1/object/upload/sign/images/1e2d6190-5d52-4f48-974c-7a5a43a50bf3/4f1af611-200c-4641-ba3d-fe9a01987811.jpg?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wNDg3ODljNy1mYmQ1LTQ4OWQtYjVmNC03NjM1NWFhMDRhODYiLCJhbGciOiJIUzI1NiJ9.eyJvd25lciI6IjFlMmQ2MTkwLTVkNTItNGY0OC05NzRjLTdhNWE0M2E1MGJmMyIsInVybCI6ImltYWdlcy8xZTJkNjE5MC01ZDUyLTRmNDgtOTc0Yy03YTVhNDNhNTBiZjMvNGYxYWY2MTEtMjAwYy00NjQxLWJhM2QtZmU5YTAxOTg3ODExLmpwZyIsInVwc2VydCI6ZmFsc2UsImlhdCI6MTc1NDkzMDY5MSwiZXhwIjoxNzU0OTM3ODkxfQ.ZBjj07BfPeynCAPLT4R3VneimrdiZzV4NSCUePT8znw', 'file_path': '1e2d6190-5d52-4f48-974c-7a5a43a50bf3/4f1af611-200c-4641-ba3d-fe9a01987811.jpg'}
2025-08-11 17:44:51,509 - app.main - INFO - Response status: 200
2025-08-11 17:44:52,213 - app.main - INFO - Request: GET /images/52db1980-f61f-481f-b4e4-648b3522b33f/url
2025-08-11 17:44:52,214 - app.api.endpoints.images - INFO - API request to get image URL: 52db1980-f61f-481f-b4e4-648b3522b33f
2025-08-11 17:44:52,214 - app.services.db.image_service - INFO - Getting image URL for ID: 52db1980-f61f-481f-b4e4-648b3522b33f
2025-08-11 17:44:52,446 - app.services.db.base_service - ERROR - Error in get_image_url: Cannot find publicUrl in response
2025-08-11 17:44:52,446 - app.main - INFO - Response status: 200
2025-08-11 17:45:36,929 - app.main - INFO - Request: POST /images/temp-upload
2025-08-11 17:45:36,937 - app.api.endpoints.images - INFO - User ID from endpoint: 1e2d6190-5d52-4f48-974c-7a5a43a50bf3
2025-08-11 17:45:36,937 - app.api.endpoints.images - INFO - User ID type: <class 'str'>
2025-08-11 17:45:36,937 - app.api.endpoints.images - INFO - JWT token length: 871
2025-08-11 17:45:36,937 - app.api.endpoints.images - INFO - JWT starts with: eyJhbGciOiJIUzI1NiIsImtpZCI6IlZxeno3RjFVNVFDSmkvN2...
2025-08-11 17:45:37,075 - app.api.endpoints.images - INFO - User client created successfully: True
2025-08-11 17:45:37,208 - app.api.endpoints.images - INFO - Test query successful: True
2025-08-11 17:45:37,209 - app.services.db.image_service - INFO - Creating temp image with path: 1e2d6190-5d52-4f48-974c-7a5a43a50bf3/b7f49b40-028a-4e1b-be0b-4468dd1d9683.jpg
2025-08-11 17:45:37,209 - app.services.db.image_service - INFO - User ID to insert: 1e2d6190-5d52-4f48-974c-7a5a43a50bf3 (type: <class 'str'>)
2025-08-11 17:45:37,323 - app.services.db.image_service - INFO - About to insert: {'file_path': '1e2d6190-5d52-4f48-974c-7a5a43a50bf3/b7f49b40-028a-4e1b-be0b-4468dd1d9683.jpg', 'user_id': '1e2d6190-5d52-4f48-974c-7a5a43a50bf3', 'status': 'temporary', 'expires_at': '2025-08-12T16:45:37.323424'}
2025-08-11 17:45:37,474 - app.services.db.image_service - INFO - Created temp image record with ID: a7f60024-37e9-4aa5-9e7e-06203a705f7f
2025-08-11 17:45:37,475 - app.services.db.image_service - INFO - About to create signed URL...
2025-08-11 17:45:37,654 - app.services.db.image_service - INFO - Signed URL response type: <class 'dict'>
2025-08-11 17:45:37,654 - app.services.db.image_service - INFO - Signed URL response: {'signed_url': 'https://sfniyudipwsaqwuhsdcq.supabase.co/storage/v1/object/upload/sign/images/1e2d6190-5d52-4f48-974c-7a5a43a50bf3/b7f49b40-028a-4e1b-be0b-4468dd1d9683.jpg?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wNDg3ODljNy1mYmQ1LTQ4OWQtYjVmNC03NjM1NWFhMDRhODYiLCJhbGciOiJIUzI1NiJ9.eyJvd25lciI6IjFlMmQ2MTkwLTVkNTItNGY0OC05NzRjLTdhNWE0M2E1MGJmMyIsInVybCI6ImltYWdlcy8xZTJkNjE5MC01ZDUyLTRmNDgtOTc0Yy03YTVhNDNhNTBiZjMvYjdmNDliNDAtMDI4YS00ZTFiLWJlMGItNDQ2OGRkMWQ5NjgzLmpwZyIsInVwc2VydCI6ZmFsc2UsImlhdCI6MTc1NDkzMDczNywiZXhwIjoxNzU0OTM3OTM3fQ.9bcFoChBNFdr67gI-pap5fJO_GUdt2kG2_tcicgDomg', 'signedUrl': 'https://sfniyudipwsaqwuhsdcq.supabase.co/storage/v1/object/upload/sign/images/1e2d6190-5d52-4f48-974c-7a5a43a50bf3/b7f49b40-028a-4e1b-be0b-4468dd1d9683.jpg?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wNDg3ODljNy1mYmQ1LTQ4OWQtYjVmNC03NjM1NWFhMDRhODYiLCJhbGciOiJIUzI1NiJ9.eyJvd25lciI6IjFlMmQ2MTkwLTVkNTItNGY0OC05NzRjLTdhNWE0M2E1MGJmMyIsInVybCI6ImltYWdlcy8xZTJkNjE5MC01ZDUyLTRmNDgtOTc0Yy03YTVhNDNhNTBiZjMvYjdmNDliNDAtMDI4YS00ZTFiLWJlMGItNDQ2OGRkMWQ5NjgzLmpwZyIsInVwc2VydCI6ZmFsc2UsImlhdCI6MTc1NDkzMDczNywiZXhwIjoxNzU0OTM3OTM3fQ.9bcFoChBNFdr67gI-pap5fJO_GUdt2kG2_tcicgDomg', 'token': 'eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wNDg3ODljNy1mYmQ1LTQ4OWQtYjVmNC03NjM1NWFhMDRhODYiLCJhbGciOiJIUzI1NiJ9.eyJvd25lciI6IjFlMmQ2MTkwLTVkNTItNGY0OC05NzRjLTdhNWE0M2E1MGJmMyIsInVybCI6ImltYWdlcy8xZTJkNjE5MC01ZDUyLTRmNDgtOTc0Yy03YTVhNDNhNTBiZjMvYjdmNDliNDAtMDI4YS00ZTFiLWJlMGItNDQ2OGRkMWQ5NjgzLmpwZyIsInVwc2VydCI6ZmFsc2UsImlhdCI6MTc1NDkzMDczNywiZXhwIjoxNzU0OTM3OTM3fQ.9bcFoChBNFdr67gI-pap5fJO_GUdt2kG2_tcicgDomg', 'path': '1e2d6190-5d52-4f48-974c-7a5a43a50bf3/b7f49b40-028a-4e1b-be0b-4468dd1d9683.jpg'}
2025-08-11 17:45:37,655 - app.services.db.image_service - INFO - Successfully created upload URL
2025-08-11 17:45:37,655 - app.services.db.image_service - INFO - Returning response: {'image_id': 'a7f60024-37e9-4aa5-9e7e-06203a705f7f', 'upload_url': 'https://sfniyudipwsaqwuhsdcq.supabase.co/storage/v1/object/upload/sign/images/1e2d6190-5d52-4f48-974c-7a5a43a50bf3/b7f49b40-028a-4e1b-be0b-4468dd1d9683.jpg?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV8wNDg3ODljNy1mYmQ1LTQ4OWQtYjVmNC03NjM1NWFhMDRhODYiLCJhbGciOiJIUzI1NiJ9.eyJvd25lciI6IjFlMmQ2MTkwLTVkNTItNGY0OC05NzRjLTdhNWE0M2E1MGJmMyIsInVybCI6ImltYWdlcy8xZTJkNjE5MC01ZDUyLTRmNDgtOTc0Yy03YTVhNDNhNTBiZjMvYjdmNDliNDAtMDI4YS00ZTFiLWJlMGItNDQ2OGRkMWQ5NjgzLmpwZyIsInVwc2VydCI6ZmFsc2UsImlhdCI6MTc1NDkzMDczNywiZXhwIjoxNzU0OTM3OTM3fQ.9bcFoChBNFdr67gI-pap5fJO_GUdt2kG2_tcicgDomg', 'file_path': '1e2d6190-5d52-4f48-974c-7a5a43a50bf3/b7f49b40-028a-4e1b-be0b-4468dd1d9683.jpg'}
2025-08-11 17:45:37,656 - app.main - INFO - Response status: 200
2025-08-11 17:45:38,506 - app.main - INFO - Request: GET /images/a7f60024-37e9-4aa5-9e7e-06203a705f7f/url
2025-08-11 17:45:38,509 - app.api.endpoints.images - INFO - API request to get image URL: a7f60024-37e9-4aa5-9e7e-06203a705f7f
2025-08-11 17:45:38,509 - app.services.db.image_service - INFO - Getting image URL for ID: a7f60024-37e9-4aa5-9e7e-06203a705f7f
2025-08-11 17:45:38,762 - app.services.db.base_service - ERROR - Error in get_image_url: Cannot find publicUrl in response
2025-08-11 17:45:38,763 - app.main - INFO - Response status: 200
