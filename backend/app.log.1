2025-04-18 18:34:24,266 - app.api.endpoints.llm - INFO - Conversation bundle ID: None
2025-04-18 18:34:24,269 - app.api.endpoints.llm - INFO - No bundle ID found for conversation
2025-04-18 18:34:24,271 - app.services.workout_analysis_service - INFO - Initialized conversation with 1 messages
2025-04-18 18:34:24,271 - app.api.endpoints.llm - INFO - Initialized conversation with 1 messages
2025-04-18 18:34:26,036 - app.api.endpoints.llm - INFO - Processing message of type: analyze_workout
2025-04-18 18:34:26,037 - app.services.workout_analysis_service - INFO - === WORKOUT ANALYSIS REQUEST RECEIVED ===
2025-04-18 18:34:26,037 - app.services.workout_analysis_service - INFO - Message keys: ['type', 'message', 'data', 'conversation_id']
2025-04-18 18:34:26,038 - app.services.workout_analysis_service - INFO - Using conversation ID: 29763840-e207-49ff-8f0a-74a7dff1ba6a (client-provided: True)
2025-04-18 18:34:26,038 - app.services.workout_analysis_service - INFO - Data string length: 742
2025-04-18 18:34:26,038 - app.services.workout_analysis_service - INFO - Data preview: {"id":"temp-1744997635716","user_id":"1e2d6190-5d52-4f48-974c-7a5a43a50bf3","name":"Baloney","notes":"[\"\"]","created_at":"2025-04-18T17:33:55.716Z","updated_at":"2025-04-18T17:33:55.716Z","workout_e...
2025-04-18 18:34:26,038 - app.services.workout_analysis_service - INFO - âœ… Successfully parsed workout data
2025-04-18 18:34:26,038 - app.services.workout_analysis_service - INFO - Workout name: Baloney
2025-04-18 18:34:26,038 - app.services.workout_analysis_service - INFO - Workout ID: temp-1744997635716
2025-04-18 18:34:26,038 - app.services.workout_analysis_service - INFO - Using user ID from workout: 1e2d6190-5d52-4f48-974c-7a5a43a50bf3
2025-04-18 18:34:26,038 - app.services.workout_analysis_service - INFO - Extracted 1 exercise names: ['weighted dip']
2025-04-18 18:34:26,038 - app.services.workout_analysis_service - INFO - Fetching historical workout data for user 1e2d6190-5d52-4f48-974c-7a5a43a50bf3
2025-04-18 18:34:26,134 - app.services.workout_analysis_service - INFO - âœ… Retrieved 1 historical workouts
2025-04-18 18:34:26,135 - app.services.workout_analysis_service - INFO - [35mCalculating workout metrics in message handler[0m
2025-04-18 18:34:26,135 - app.services.workout_analysis_service - INFO - [35mâœ… Successfully added metrics to workout data[0m
2025-04-18 18:34:26,135 - app.services.workout_analysis_service - INFO - [35mMetrics categories: ['exercise_progression', 'strength_progression', 'most_improved_exercises', 'workout_frequency'][0m
2025-04-18 18:34:26,135 - app.services.workout_analysis_service - INFO - [35mSample workout_frequency: total_workouts = 1...[0m
2025-04-18 18:34:26,135 - app.services.workout_analysis_service - INFO - Starting workout analysis for user 1e2d6190-5d52-4f48-974c-7a5a43a50bf3
2025-04-18 18:34:26,135 - app.services.workout_analysis_service - INFO - Correlation analysis complete: found 0 significant correlations
2025-04-18 18:34:26,135 - app.services.workout_analysis_service - INFO - [35mCalculating advanced workout metrics[0m
2025-04-18 18:34:26,135 - app.services.workout_analysis_service - INFO - [35mAdded metrics to workout data: ['exercise_progression', 'strength_progression', 'most_improved_exercises', 'workout_frequency'][0m
2025-04-18 18:34:26,135 - app.services.workout_analysis_service - INFO - Creating enhanced workout bundle
2025-04-18 18:34:26,136 - app.services.workout_analysis.graph_service - INFO - Getting top performers for metric: 1rm_change
2025-04-18 18:34:26,136 - app.services.workout_analysis.graph_service - WARNING - No significant performers found for 1rm_change
2025-04-18 18:34:26,136 - app.services.workout_analysis.graph_service - INFO - Getting top performers for metric: volume_change
2025-04-18 18:34:26,136 - app.services.workout_analysis.graph_service - WARNING - No significant performers found for volume_change
2025-04-18 18:34:26,136 - app.services.chains.workout_analysis_chain - INFO - Added workout data bundle to conversation context
2025-04-18 18:34:26,136 - app.services.chains.workout_analysis_chain - INFO - Bundle has 0 charts available
2025-04-18 18:34:26,136 - app.services.chains.workout_analysis_chain - INFO - Top strength performer: None
2025-04-18 18:34:26,136 - app.services.workout_analysis_service - INFO - Generating multiple charts
2025-04-18 18:34:26,136 - app.services.workout_analysis.graph_service - INFO - Getting top performers for metric: 1rm_change
2025-04-18 18:34:26,136 - app.services.workout_analysis.graph_service - WARNING - No significant performers found for 1rm_change
2025-04-18 18:34:26,136 - app.services.workout_analysis.graph_service - INFO - Getting top performers for metric: volume_change
2025-04-18 18:34:26,136 - app.services.workout_analysis.graph_service - WARNING - No significant performers found for volume_change
2025-04-18 18:34:26,136 - app.services.workout_analysis.graph_service - INFO - Strength chart contains 0 exercises with data
2025-04-18 18:34:26,881 - app.services.workout_analysis.graph_service - INFO - Generating volume chart for 0 exercises
2025-04-18 18:34:26,881 - app.services.workout_analysis.graph_service - INFO - Volume chart contains 0 exercises with data
2025-04-18 18:34:28,388 - app.services.workout_analysis_service - INFO - Generated 3 charts
2025-04-18 18:34:28,391 - app.core.supabase.client - INFO - Linking bundle 13101f51-7c42-422b-809c-f5094d6f42c5 to conversation 29763840-e207-49ff-8f0a-74a7dff1ba6a
2025-04-18 18:34:28,391 - app.core.supabase.client - INFO - Sending bundle-conversation link request: bundle_id=13101f51-7c42-422b-809c-f5094d6f42c5, conversation_id=29763840-e207-49ff-8f0a-74a7dff1ba6a
2025-04-18 18:34:28,526 - app.core.supabase.client - INFO - âœ… Successfully linked bundle 13101f51-7c42-422b-809c-f5094d6f42c5 to conversation 29763840-e207-49ff-8f0a-74a7dff1ba6a
2025-04-18 18:34:28,526 - app.services.workout_analysis_service - INFO - âœ… Bundle 13101f51-7c42-422b-809c-f5094d6f42c5 successfully linked to conversation 29763840-e207-49ff-8f0a-74a7dff1ba6a
2025-04-18 18:34:28,529 - app.services.chains.base_conversation_chain - INFO - 
=== Formatted Messages ===
2025-04-18 18:34:28,530 - app.services.chains.base_conversation_chain - INFO - 
Message 1 (SystemMessage):
2025-04-18 18:34:28,530 - app.services.chains.base_conversation_chain - INFO - Content: You are a workout analysis assistant with access to the user's workout data metrics. When responding:

1. Always check the available_data.workout_metrics in your context first
2. Prioritize discussing the most significant insights from the metrics:
   - For exercise_progression: Focus on weight changes and volume trends
   - For strength_progression: Highlight estimated 1RM improvements and monthly rates
   - For workout_frequency: Mention consistency scores and workout patterns
   - For most_improved_exercises: Always mention the top performers

3. Be specific with numbers when discussing progress:
   - "Your bench press 1RM has increased by 15kg (12%) over 3 months, at a rate of 5kg per month"
   - "Your workout consistency score is 85/100, with an average of 3.2 workouts per week"
   

4. Interpret metrics in context:
   - Explain what the numbers mean for the user's fitness journey
   - Compare progress across different exercises when relevant
   - Note any potential plateaus or exceptional improvements

5. Acknowledge correlations when available by highlighting significant relationships

Try to keep responses concise (under 100 tokens when possible) while still discussing the most relevant metrics.


Current workout data context:
Available workout data:
            {
  "available_data": {
    "query": "Analyze my \"Baloney\" workout and show how it relates to my previous workouts. Look for patterns and progress.",
    "date_range": {
      "start": "2025-04-18T17:34:20.045000+00:00",
      "end": "2025-04-18T17:34:20.045000+00:00"
    },
    "workout_metrics": {
      "exercise_progression": {},
      "strength_progression": {},
      "most_improved_exercises": [],
      "workout_frequency": {
        "total_workouts": 1,
        "first_workout": "2025-04-18",
        "last_workout": "2025-04-18",
        "total_days": 1,
        "avg_days_between": 0,
        "workouts_per_week": 0,
        "consistency_score": {
          "score": 0,
          "streak": 0
        }
      }
    },
    "total_workouts": 1,
    "correlation_analysis": []
  }
}

Visualizations and metrics:

CHARTS:
Strength Progress Chart, Volume Progress Chart, Weekly Workout Frequency Chart

CONSISTENCY METRICS:
- Score: 0/100
- Current streak: 0 workouts
- Average frequency: Every 0.0 days

TOP PERFORMERS:
- Strength gains: No significant strength gains detected
- Volume increases: No significant volume increases detected
- Most frequent exercises: Not enough data

2025-04-18 18:34:28,530 - app.services.chains.base_conversation_chain - INFO - 
Message 2 (HumanMessage):
2025-04-18 18:34:28,530 - app.services.chains.base_conversation_chain - INFO - Content: Analyze my "Baloney" workout and show how it relates to my previous workouts. Look for patterns and progress.
2025-04-18 18:34:28,530 - app.services.chains.base_conversation_chain - INFO - 
Message 3 (HumanMessage):
2025-04-18 18:34:28,530 - app.services.chains.base_conversation_chain - INFO - Content: Analyze my "Baloney" workout and show how it relates to my previous workouts. Look for patterns and progress.
2025-04-18 18:34:28,531 - app.services.chains.base_conversation_chain - INFO - =====================
2025-04-18 18:34:32,129 - app.services.workout_analysis_service - INFO - ================================================================================
2025-04-18 18:34:32,129 - app.services.workout_analysis_service - INFO - WORKOUT ANALYSIS COMPLETE - SUMMARY:
2025-04-18 18:34:32,130 - app.services.workout_analysis_service - INFO - User ID: 1e2d6190-5d52-4f48-974c-7a5a43a50bf3
