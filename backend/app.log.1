2025-06-05 15:37:06,545 - app.api.endpoints.db - INFO - API request to create conversation: Workout Analysis
2025-06-05 15:37:06,549 - app.services.db.conversation_service - INFO - Creating conversation with title: Workout Analysis for user: 1e2d6190-5d52-4f48-974c-7a5a43a50bf3
2025-06-05 15:37:06,745 - app.services.db.conversation_service - INFO - Conversation created with ID: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:06,746 - app.main - INFO - Response status: 200
2025-06-05 15:37:06,797 - app.main - INFO - Request: GET /db/conversations/355588cc-9609-4da0-93d0-305031381587/messages
2025-06-05 15:37:06,855 - app.api.endpoints.db - INFO - API request to get messages for conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:06,856 - app.services.db.conversation_service - INFO - Getting conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:06,920 - app.services.db.conversation_service - INFO - Retrieved conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:06,921 - app.services.db.conversation_service - INFO - Getting messages for conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:06,978 - app.services.db.conversation_service - INFO - Retrieved 1 messages for conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:06,979 - app.main - INFO - Response status: 200
2025-06-05 15:37:07,016 - app.services.llm.workout_analysis - INFO - WebSocket connection accepted for conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:19,436 - app.main - INFO - Request: POST /db/conversations/355588cc-9609-4da0-93d0-305031381587/messages
2025-06-05 15:37:19,552 - app.api.endpoints.db - INFO - API request to save message to conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:19,553 - app.services.db.conversation_service - INFO - Getting conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:19,668 - app.services.db.conversation_service - INFO - Retrieved conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:19,668 - app.services.db.conversation_service - INFO - Saving user message to conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:19,740 - app.services.db.conversation_service - INFO - Message saved with ID: 7de4c51b-e994-4410-9273-837316f38446
2025-06-05 15:37:19,742 - app.main - INFO - Response status: 200
2025-06-05 15:37:19,891 - app.services.chains.base_conversation_chain - INFO - 
=== Formatted Messages ===
2025-06-05 15:37:19,893 - app.services.chains.base_conversation_chain - INFO - 
Message 1 (SystemMessage):
2025-06-05 15:37:19,893 - app.services.chains.base_conversation_chain - INFO - Content: You are a workout analysis assistant with access to the user's workout data metrics. When responding:

1. Always check the available_data.workout_metrics in your context first
2. Prioritize discussing the most significant insights from the metrics:
   - For exercise_progression: Focus on weight changes and volume trends
   - For strength_progression: Highlight estimated 1RM improvements and monthly rates
   - For workout_frequency: Mention consistency scores and workout patterns
   - For most_improved_exercises: Always mention the top performers

3. Be specific with numbers when discussing progress:
   - "Your bench press 1RM has increased by 15kg (12%) over 3 months, at a rate of 5kg per month"
   - "Your workout consistency score is 85/100, with an average of 3.2 workouts per week"
   

4. Interpret metrics in context:
   - Explain what the numbers mean for the user's fitness journey
   - Compare progress across different exercises when relevant
   - Note any potential plateaus or exceptional improvements

5. Acknowledge correlations when available by highlighting significant relationships

Try to keep responses concise (under 100 tokens when possible) while still discussing the most relevant metrics.


Current workout data context:
Available workout data:
            {
  "available_data": []
}

Visualizations and metrics:
No workout data available
2025-06-05 15:37:19,893 - app.services.chains.base_conversation_chain - INFO - 
Message 2 (HumanMessage):
2025-06-05 15:37:19,894 - app.services.chains.base_conversation_chain - INFO - Content: Hello!
2025-06-05 15:37:19,894 - app.services.chains.base_conversation_chain - INFO - =====================
2025-06-05 15:37:23,646 - app.main - INFO - Request: POST /db/conversations/355588cc-9609-4da0-93d0-305031381587/messages
2025-06-05 15:37:23,727 - app.api.endpoints.db - INFO - API request to save message to conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:23,727 - app.services.db.conversation_service - INFO - Getting conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:23,787 - app.services.db.conversation_service - INFO - Retrieved conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:23,788 - app.services.db.conversation_service - INFO - Saving assistant message to conversation: 355588cc-9609-4da0-93d0-305031381587
2025-06-05 15:37:23,860 - app.services.db.conversation_service - INFO - Message saved with ID: e12cb024-07b2-49a6-9c99-0f4b806b0aaf
2025-06-05 15:37:23,861 - app.main - INFO - Response status: 200
2025-06-05 15:42:11,170 - app.services.llm.workout_analysis - ERROR - Error in LLM websocket: (1000, '')
Traceback (most recent call last):
  File "/Users/mileshillary/Documents/supreme-octo-doodle/backend/app/services/llm/workout_analysis.py", line 56, in process_websocket
    data = await websocket.receive_json()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/starlette/websockets.py", line 135, in receive_json
    self._raise_on_disconnect(message)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/starlette/websockets.py", line 113, in _raise_on_disconnect
    raise WebSocketDisconnect(message["code"], message.get("reason"))
starlette.websockets.WebSocketDisconnect: (1000, '')
2025-06-05 15:42:11,210 - app.main - INFO - Request: POST /api/workout-analysis
2025-06-05 15:42:11,665 - app.services.workout_analysis.graph_service - INFO - Getting top performers for metric: 1rm_change
2025-06-05 15:42:11,667 - app.services.workout_analysis.graph_service - INFO - Top 1rm_change performers: ['Overhead Press', 'Incline Dumbbell Press', 'Bench Press']
2025-06-05 15:42:11,667 - app.services.workout_analysis.graph_service - INFO - Getting top performers for metric: volume_change
2025-06-05 15:42:11,668 - app.services.workout_analysis.graph_service - INFO - Top volume_change performers: ['Overhead Press', 'Incline Dumbbell Press', 'Bench Press']
2025-06-05 15:42:11,669 - app.services.workout_analysis.graph_service - INFO - Getting top performers for metric: 1rm_change
2025-06-05 15:42:11,670 - app.services.workout_analysis.graph_service - INFO - Top 1rm_change performers: ['Overhead Press', 'Incline Dumbbell Press', 'Bench Press']
2025-06-05 15:42:11,670 - app.services.workout_analysis.graph_service - INFO - Getting top performers for metric: volume_change
2025-06-05 15:42:11,670 - app.services.workout_analysis.graph_service - INFO - Top volume_change performers: ['Overhead Press', 'Incline Dumbbell Press', 'Bench Press']
2025-06-05 15:42:11,671 - app.services.workout_analysis.graph_service - INFO - Added 51 data points for Overhead Press to strength chart
2025-06-05 15:42:11,671 - app.services.workout_analysis.graph_service - INFO - Added 51 data points for Incline Dumbbell Press to strength chart
2025-06-05 15:42:11,672 - app.services.workout_analysis.graph_service - INFO - Added 51 data points for Bench Press to strength chart
2025-06-05 15:42:11,672 - app.services.workout_analysis.graph_service - INFO - Strength chart contains 3 exercises with data
2025-06-05 15:42:12,571 - app.services.workout_analysis.graph_service - INFO - Generating volume chart for 3 exercises
2025-06-05 15:42:12,571 - app.services.workout_analysis.graph_service - INFO - Added 51 data points for Overhead Press to volume chart
2025-06-05 15:42:12,572 - app.services.workout_analysis.graph_service - INFO - Added 51 data points for Incline Dumbbell Press to volume chart
2025-06-05 15:42:12,572 - app.services.workout_analysis.graph_service - INFO - Added 51 data points for Bench Press to volume chart
2025-06-05 15:42:12,572 - app.services.workout_analysis.graph_service - INFO - Volume chart contains 3 exercises with data
2025-06-05 15:42:14,010 - app.main - INFO - Response status: 202
2025-06-05 15:42:16,203 - app.main - INFO - Request: GET /db/user-profile
2025-06-05 15:42:16,344 - app.api.endpoints.db - INFO - API request to get profile for user: 1e2d6190-5d52-4f48-974c-7a5a43a50bf3
2025-06-05 15:42:16,344 - app.services.db.user_profile_service - INFO - Getting profile for user: 1e2d6190-5d52-4f48-974c-7a5a43a50bf3
2025-06-05 15:42:16,448 - app.services.db.user_profile_service - INFO - Successfully retrieved profile for user: 1e2d6190-5d52-4f48-974c-7a5a43a50bf3
2025-06-05 15:42:16,450 - app.main - INFO - Request: GET /db/exercise-definitions
2025-06-05 15:42:16,450 - app.main - INFO - Response status: 200
2025-06-05 15:42:16,513 - app.api.endpoints.db - INFO - API request to get all exercise definitions
2025-06-05 15:42:16,513 - app.services.db.exercise_definition_service - INFO - Fetching all exercise definitions
2025-06-05 15:42:16,657 - app.services.db.exercise_definition_service - INFO - Fetched 167 exercise definitions
2025-06-05 15:42:16,664 - app.main - INFO - Response status: 200
2025-06-05 15:42:16,735 - app.main - INFO - Request: GET /db/workouts/templates
2025-06-05 15:42:16,839 - app.api.endpoints.db - INFO - API request to get workout templates for user: 1e2d6190-5d52-4f48-974c-7a5a43a50bf3
2025-06-05 15:42:16,840 - app.services.db.workout_service - INFO - Getting workout templates for user: 1e2d6190-5d52-4f48-974c-7a5a43a50bf3
